{% extends "base.html" %}

{% block title %}Profile{% endblock %}

{% block head %}
    <link rel="canonical" href="https://kjhjason.com/admin/profile" />
    <meta name="robots" content="noindex, nofollow">
{% endblock %}

{% block content %}
<div class="gap-y-8 grid grid-cols-1">
    <div class="collapse collapse-arrow accent">
        <input type="radio" name="profile-accordion" checked="checked" /> 
        <div class="collapse-title text-xl font-medium">
            Change Password
        </div>
        <form class="collapse-content"
            hx-patch="/api/admin/change-password"
            hx-headers='{{ common.csrf_header_json|safe }}'
            hx-target="#password-change-alert"
            hx-target-error="#password-change-alert"
            hx-ext="response-targets"
        > 
            <div id="password-change-alert" class="my-4" hx-on::after-swap="handle2FaAlert(event)"></div>

            <label for="current-password" class="block my-2 text-sm font-medium text-neutral-900 dark:text-white">Current Password:</label>
            <input type="text" name="current-password" id="current-password" class="input-theme mb-4" placeholder="AbcdEF@H1!" required minlength="8" maxlength="64" />

            <label for="new-password" class="block mb-2 text-sm font-medium text-neutral-900 dark:text-white">New Password:</label>
            <input type="text" name="new-password" id="new-password" class="input-theme mb-4" placeholder="aBcdEF@H2!" required minlength="8" maxlength="64" />

            <label for="confirm-password" class="block mb-2 text-sm font-medium text-neutral-900 dark:text-white">Confirm Password:</label>
            <input type="text" name="confirm-password" id="confirm-password" class="input-theme mb-4" placeholder="aBcdEF@H2!" required minlength="8" maxlength="64" />

            <div class="w-full text-right">
                <button type="submit" class="btn btn-success">Submit</button>
            </div>
        </form>
    </div>

    {% let csrf_header_json = common.csrf_header_json|as_ref %}
    <div id="two-fa-setting">
        {% if has_2fa %}
            {% include "components/disable_2fa.html" %}
        {% else %}
            {% include "components/enable_2fa.html" %}
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script nonce="{{ common.nonce }}" src="/static/js/twofa.js"></script>
    <script nonce="{{ common.nonce }}">
        csrfHeaderName = "{{ common.csrf_header }}";
        csrfValue = "{{ common.csrf_value }}";

        const handle2FaAlert = (event) => {
            console.log(event);
            
        };
    </script>
{% endblock %}
